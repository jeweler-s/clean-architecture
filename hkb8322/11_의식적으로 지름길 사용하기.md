# 왜 지름길은 깨진 창문 같을까?

> 어떤 것이 멈춘 것처럼 보이고, 혹은 관리되지 않는다고 여겨지면
뇌는 이를 더 멈추고, 망가뜨려도 된다고 생각하게 된다.
> 

깨진 창문 법칙이 코드 작업에 적용될 경우 의미는 아래와 같음

- 품질이 떨어진 코드에서 작업할 때 더 낮은 품질의 코드를 추가하기가 쉽다.
- 코딩 규칙을 많이 어긴 코드에서 작업할 때 또 다른 규칙을 어기기도 쉽다.
- 지름길을 많이 사용한 코드에서 작업할 때 또 다른 지름길을 추가하기도 쉽다.

⇒ `레거시` 로 불리는 많은 코드는 시간이 흐르며 품질이 심하게 낮아졌음

# 깨끗한 상태로 시작할 책임

우리는 모두 깨진 창문 심리에 무의식적으로 영향을 받으므로…

- 가능한 한 지름길을 거의  쓰지 않고 기술 부채를 지지 않은 채로 깨끗히 시작 필요
- 의도적인 지름길에 대해서는 아키텍처 결정 기록 등 세심히 기록 필요

# 지름길의 예시와 효과

## 1) 유스케이스 간 모델 공유하기

(그림 11.1)

- 유스케이스가 같은 입출력 모델(`SendMoneyCommand` 등) 공유 시 유스케이스 간 결합 발생
    - 이는 변경할 이유를 공유하는 것
- 유스케이스 간 입출력 모델 공유는 유스케이스들이 기능적으로 묶여 있을 때 유효
    - 특정 세부사항 변경 시 연관된 유스케이스 모두 영향을 주고 싶은 경우
- 유스케이스를 독립적으로 진화할 필요가 있는지 주기적으로 확인 필요

## 2) 도메인 엔티티를 입출력 모델로 사용하기

(그림 11.2)

- 인커밍 포트가 도메인 엔티티를 의존하는 상황의 경우 해당 도메인에 존재하지 않는 정보를 유스케이스가 필요로 할 때, 도메인에 불필요한 필드를 추가할 확률 증가
- 복잡한 도메인 로직 구현 시 유스케이스 인터페이스에 대한 전용 입출력 모델을 만들어야 함
- 유스케이스의 변경이 도메인 엔티티까지 전파되지 않게 하기 위함

## 3) 인커밍 포트 건너뛰기

(그림 11.3)

- 인커밍 포트는 애플리케이션 중심에 접근하는 진입점을 정의하는데,
이를 제거할 경우 애플리케이션 내부 동작 파악이 어려워짐
- 인커밍 포트를 유지해야 아키텍처 강제에 유리함
    - 인커밍 어댑터가 인커밍 포트만 호출하도록 강제 가능

## 4) 애플리케이션 서비스 건너뛰기

(그림 11.4)

- 애플리케이션 서비스 없이 영속성 어댑터로 대체하는 경우,
인커밍 어댑터와 아웃고잉 어댑터 사이 모델 공유 필요
    - 도메인 모델을 입력 모델로 사용하는 케이스 발생
- 애플리케이션 코어에 유스케이스라고 불릴만한 것이 존재하지 않게 됨
    - 도메인 로직이 흩어져 유지보수성 저하

# 결론

- 유스케이스가 CRUD 상태에서 벗어나는 시점이 언제인지에 대해 팀이 합의하는 것이 매우 중요
- 어떤 경우든 아키텍처 및 의도적인 지름길을 선택한 이유는 기록하자
